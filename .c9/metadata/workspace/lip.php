{"changed":true,"filter":false,"title":"lip.php","tooltip":"/lip.php","value":"<?PHP\n \n   /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n   * displayResult( ) - Execute a query and display the result\n   *    Parameters:  $rs -  result set to display as 2D array\n   *                 $sql - SQL string used to display an error msg\n   * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\n         // Server Sniffer based on available connection:\n         \n             $whitelist = array('127.0.0.1', '::1');\n         \n             if(in_array($_SERVER['REMOTE_ADDR'], $whitelist))\n\n            {\n                 // Set up connection constants\n                 // Using default username and password for AMPPS\n                 define(\"SERVER_NAME\",\"localhost\");\n                 define(\"DBF_USER\", \"root\");\n                 define(\"DBF_PASSWORD\", \"mysql\");\n                 define(\"DATABASE_NAME\", \"group3Project\");\n             }\n         \n             else\n            {\n                // credentials for http://sspgroup3.byethost9.com/\n                define('SERVER_NAME', 'sql204.byethost9.com');\n                define('DBF_USER', 'b9_20707120');\n                define('DBF_PASSWORD', 'zaagOnEm');\n                define('DATABASE_NAME', 'b9_20707120_RaceRegistration');\n            }  \n        // Create connection object\n         $conn = new mysqli(SERVER_NAME, DBF_USER, DBF_PASSWORD, DATABASE_NAME);\n       \n         // Check connection\n         if ($conn->connect_error) {\n             die(\"Connection failed: \" . $conn->connect_error);\n         }\n    \n         // Select the database\n         $conn->select_db(DATABASE_NAME);\n        /* =========================================\n         Functions are alphabetical\n         ========================================= */\n         function addRecord( )\n         {\n        \n         global $raceEditArray;\n         // Add the new information into the array\n         // items stacked for readability\n         $raceEditArray[ ] = array(\n         $_POST['txtraceName'],\n         $_POST['txtraceCourse']\n         );\n     \n         // The sort will be on the first column so we will use this to re-order the displays\n         sort($raceEditArray);\n         // Save the updated array in its session variable\n         $_SESSION['serializedArray'] = urlencode(serialize($raceEditArray));\n         \n        foreach ($raceEditArray as $editRace)\n         {\n          $sql = \"INSERT INTO race (raceID, raceName, raceCourse)\"\n              . \"VALUES ('\" . null . \"','\"\n              . $_POST['txtraceName'] . \"', '\"\n              . $_POST['txtraceCourse'] . \"')\";\n            runQuery($sql, \"Record inserted for: \" . $_POST['txtraceName'], false);\n         }//end of foreach\n         } // end of addRecord( )\n        \n        function deleteRecord( )\n         {\n         global $raceEditArray;\n         global $deleteMe;\n         // Get the selected index from the lstItem\n         $deleteMe = $_POST['lstItem'];\n         // Remove the selected index from the array\n         unset($raceEditArray[$deleteMe]);\n         // Save the updated array in its session variable\n         $_SESSION['serializedArray'] = urlencode(serialize($raceEditArray));\n         echo \"<h2>Record deleted</h2>\";\n         } // end of deleteRecord( )\n\n        function displayRaceForm( )\n         {\n         global $raceEditArray; \n         echo (\"<div class='row'>\");\n         echo (\"<div class='center-block col-xs-8'>\");\n         echo (\"<h2 id='places'>Bike Race Edit Form</h2>\");         \n         echo (\"<div class='bs-example'>\");\n         echo (\"<div class='table-responsive'>\");\n         echo(\"<table class= 'table table-bordered table-striped table-hover>'\");\n         // display the header\n         echo \"<tr>\";\n         echo \"<th>Race Name</th>\";\n         echo \"<th>Race Course</th>\";\n         echo \"</tr>\";\n         \n         // Walk through each record or row\n         foreach($raceEditArray as $record)\n         {\n         echo \"<tr>\";\n         // for each column in the row\n         foreach($record as $value)\n         {\n         echo \"<td>$value</td>\";\n         }\n         echo \"</tr>\";\n         }\n         // stop the table\n         echo \"</table>\";\n         } // end of displayRaceForm( )\n\n\n    function displayData( ) {\n\t\tglobal $sql;\n\t\tglobal $tableFormat;\n        $db = new mysqli(SERVER_NAME, DBF_USER, DBF_PASSWORD, DATABASE_NAME);\n\t\tif($db->connect_errno > 0){\n\t\t die('Unable to connect to database [' . $db->connect_error . ']');\n\t\t}\n\n\t\t// Get the data from the database using SQL\n\t\tif(!$result = $db->query($sql)){\n\t\t die('There was an error running the query [' . $db->error . ']');\n\t\t}\n\n        // Display the records in a table\n        switch($tableFormat) {\n        case AVAILABLE_RACE:\n    {\n        echo (\"<div class='row'>\");\n        echo (\"<div class='center-block col-xs-8'>\");        \n        echo (\"<div class='bs-example'>\");\n        echo (\"<div class='table-responsive'>\");\n        echo '<h2>List of Races </h2>';\n        echo(\"<table class= 'table table-bordered table-striped table-hover>'\");\n        echo '<tr>';\n        echo '<th>Race Name</th>';\n        echo '<th>Race Course</th>';\n        echo '</tr>';\n        while($row = $result->fetch_assoc( ))\n        {\n            echo '<tr>';\n            echo '<td>' . $row['raceName'] . '</td>';\n            echo '<td>' . $row['raceCourse'] . '</td>';\n            echo '</tr>';\n        }\n        echo '</table>';\n        break;\n    }\n            break;\n\n     case CLOSED_RACE:\n    {\n        echo (\"<div class='row'>\");\n        echo (\"<div class='center-block col-xs-8'>\");        \n        echo (\"<div class='bs-example'>\");\n        echo (\"<div class='table-responsive'>\");\n        echo '<h2>List of Races </h2>';\n        echo(\"<table class= 'table table-bordered table-striped table-hover>'\");\n        echo '<tr>';\n        echo '<th>Race Name</th>';\n        echo '<th>Race Course</th>';\n        echo '</tr>';\n        while($row = $result->fetch_assoc( ))\n        {\n            echo '<tr>';\n            echo '<td>' . $row['raceName'] . '</td>';\n            echo '<td>' . $row['raceCourse'] . '</td>';\n            echo '</tr>';\n        }\n        echo '</table>';\n        break;\n    }\n            break;\n     case FEATURE_RACE:\n    {\n        echo (\"<div class='row'>\");\n        echo (\"<div class='center-block col-xs-8'>\");        \n        echo (\"<div class='bs-example'>\");\n        echo (\"<div class='table-responsive'>\");\n        echo '<h2>List of Races </h2>';\n        echo(\"<table class= 'table table-bordered table-striped table-hover>'\");\n        echo '<tr>';\n        echo '<th>Race Name</th>';\n        echo '<th>Race Course</th>';\n        echo '</tr>';\n        while($row = $result->fetch_assoc( ))\n        {\n            echo '<tr>';\n            echo '<td>' . $row['raceName'] . '</td>';\n            echo '<td>' . $row['raceCourse'] . '</td>';\n            echo '</tr>';\n        }\n        echo '</table>';\n        break;\n    }\n            break;\n\tdefault:\n\techo $tableFormat . ' is not a valid table format.<br />';\n} // end of switch( )\n\n\t\t// Close the database object\n\t\t$db->close;\n\t}\n\n\n/********************************************************************************/\n   function displayResult($result, $sql) \n   {\n \n   if ($result->num_rows > 0) {\n     echo \"<table border='1'>\\n\";\n     // print headings (field names)\n     $heading = $result->fetch_assoc( );\n     echo \"<tr>\\n\";\n     // print field names \n     foreach($heading as $key=>$value){\n        echo \"<th>\" . $key . \"</th>\\n\";\n     }\n     echo \"</tr>\\n\";\n     \n     // Print values for the first row\n     echo \"<tr>\\n\";\n     foreach($heading as $key=>$value)\n     {\n        echo \"<td>\" . $value . \"</td>\\n\";\n     }\n                \n      // output rest of the records\n      while($row = $result->fetch_assoc())\n      {\n          //print_r($row);\n          //echo \"<br />\";\n          echo \"<tr>\\n\";\n          // print data\n          foreach($row as $key=>$value) {\n             echo \"<td>\" . $value . \"</td>\\n\";\n          }\n          echo \"</tr>\\n\";\n      }\n      echo \"</table>\\n\";\n   } else {\n      echo \"<strong>zero results using SQL: </strong>\" . $sql;\n   }\n   } // end of displayResult( )\n   \n   /***************************************************\n   * Display the tables\n   ***************************************************/\n   // Table:FourTableJoin\n   function displayRace( ) {\n   global $conn;\n   $sql = \"select raceName, raceCourse from race\n   \";\n   $result = $conn->query($sql);\n   displayResult($result, $sql);\n   \n   } // end of displayFourTableJoin\n   \n       \n   /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n   * runQuery( ) - Execute a query and display message\n   * Parameters:  $sql - SQL String to be executed.\n   *              $msg - Text of message to display on success or error\n   *              $echoSuccess - boolean True=Display message on success\n   * If $echoSuccess true: $msg successful. * Error Msg Format: $msg using SQL: $sql.\n   * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\n   function runQuery($sql, $msg, $echoSuccess) {\n   global $conn;\n   // run the query\n   if ($conn->query($sql) === TRUE) {\n     if($echoSuccess) {\n        echo $msg . \" successful.<br />\";\n     }\n   } else {\n     echo \"<strong>Error when: \" . $msg . \"</strong> using SQL: \" . $sql . \"<br />\" . $conn->error;\n   }   \n   } // end of runQuery( )\n   \n   ?>","undoManager":{"mark":-1,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":27,"column":40},"end":{"row":27,"column":48},"isBackwards":true},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1507013214000}